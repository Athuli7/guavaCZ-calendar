// resources/js/calendar-widget.js
function calendarWidget({
  view = "dayGridMonth",
  locale = "en",
  firstDay = 1,
  events = [],
  eventContent = null,
  selectable = false,
  onEventClick = false,
  dayMaxEvents = false,
  moreLinkContent = null,
  resources = [],
  options = {}
}) {
  return {
    calendarEl: null,
    init: async function() {
      this.calendarEl = this.$el;
      let self = this;
      let settings = {
        view,
        resources,
        eventSources: [
          {
            events: (fetchInfo, successCallback, failureCallback) => {
              console.log("load");
              return this.$wire.getEventsJs(fetchInfo);
            }
          }
        ],
        locale,
        firstDay,
        dayMaxEvents,
        selectable: true,
        editable: false,
        eventStartEditable: false,
        select: (info) => {
          console.log("SELECT", info, info.jsEvent, info.jsEvent.target);
          const target = info.jsEvent.target;
          self.$el.querySelector("[calendar-context-menu]").dispatchEvent(new CustomEvent("calendar--open-menu", { detail: info }));
        },
        eventClick: (info) => {
          if (info.event.extendedProps.url) {
            const target = info.event.extendedProps.url_target ?? "_blank";
            window.open(info.event.extendedProps.url, target);
          } else if (onEventClick) {
            this.$wire.onEventClick(info);
          }
        }
      };
      if (eventContent !== null) {
        settings.eventContent = (info) => {
          return {
            html: self.getEventContent(info)
          };
        };
      }
      if (moreLinkContent !== null) {
        settings.moreLinkContent = (arg) => {
          return {
            html: self.getMoreLinkContent(arg)
          };
        };
      }
      this.ec = new EventCalendar(this.$el.querySelector("div"), {
        ...settings,
        ...options
      });
      window.addEventListener("ec-add-event", this.addEvent);
      window.addEventListener("calendar--refresh", () => this.ec.refetchEvents());
    },
    addEvent: function(event) {
      this.ec.addEvent(event);
    },
    getEventContent: function(info) {
      if (typeof eventContent === "string") {
        console.log("eventContent", eventContent);
        return this.wrapContent(eventContent, info);
      }
      if (typeof eventContent === "object") {
        const model = info.event.extendedProps.model;
        const content = eventContent[model];
        return this.wrapContent(content, info);
      }
    },
    getMoreLinkContent: function(info) {
      return this.wrapContent(moreLinkContent, info);
    },
    wrapContent: function(content, info) {
      let container = document.createElement("div");
      container.innerHTML = content;
      container.setAttribute("x-data", JSON.stringify(info));
      container.classList.add("w-full");
      return container.outerHTML;
    }
  };
}
export {
  calendarWidget as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vcmVzb3VyY2VzL2pzL2NhbGVuZGFyLXdpZGdldC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2FsZW5kYXJXaWRnZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcgPSAnZGF5R3JpZE1vbnRoJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbGUgPSAnZW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0RGF5ID0gMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudENvbnRlbnQgPSBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGUgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkV2ZW50Q2xpY2sgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlNYXhFdmVudHMgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3JlTGlua0NvbnRlbnQgPSBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlcyA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIHtcbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNhbGVuZGFyRWw6IG51bGwsXG5cbiAgICAgICAgaW5pdDogYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckVsID0gdGhpcy4kZWw7XG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBsZXQgc2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgdmlldzogdmlldyxcbiAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcbiAgICAgICAgICAgICAgICBldmVudFNvdXJjZXM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzOiAoZmV0Y2hJbmZvLCBzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2FkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHdpcmUuZ2V0RXZlbnRzSnMoZmV0Y2hJbmZvKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBsb2NhbGU6IGxvY2FsZSxcbiAgICAgICAgICAgICAgICBmaXJzdERheTogZmlyc3REYXksXG4gICAgICAgICAgICAgICAgZGF5TWF4RXZlbnRzOiBkYXlNYXhFdmVudHMsXG4gICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlZGl0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXZlbnRTdGFydEVkaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IChpbmZvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTRUxFQ1QnLCBpbmZvLCBpbmZvLmpzRXZlbnQsIGluZm8uanNFdmVudC50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBpbmZvLmpzRXZlbnQudGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRlbC5xdWVyeVNlbGVjdG9yKCdbY2FsZW5kYXItY29udGV4dC1tZW51XScpLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdjYWxlbmRhci0tb3Blbi1tZW51Jywge2RldGFpbDogaW5mb30pKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGV2ZW50Q2xpY2s6IChpbmZvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmV2ZW50LmV4dGVuZGVkUHJvcHMudXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBpbmZvLmV2ZW50LmV4dGVuZGVkUHJvcHMudXJsX3RhcmdldCA/PyAnX2JsYW5rJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGluZm8uZXZlbnQuZXh0ZW5kZWRQcm9wcy51cmwsIHRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob25FdmVudENsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiR3aXJlLm9uRXZlbnRDbGljayhpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChldmVudENvbnRlbnQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5ldmVudENvbnRlbnQgPSAoaW5mbykgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogc2VsZi5nZXRFdmVudENvbnRlbnQoaW5mbyksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobW9yZUxpbmtDb250ZW50ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3MubW9yZUxpbmtDb250ZW50ID0gKGFyZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogc2VsZi5nZXRNb3JlTGlua0NvbnRlbnQoYXJnKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWMgPSBuZXcgRXZlbnRDYWxlbmRhcih0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCdkaXYnKSwge1xuICAgICAgICAgICAgICAgIC4uLnNldHRpbmdzLFxuICAgICAgICAgICAgICAgIC4uLm9wdGlvbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2VjLWFkZC1ldmVudCcsIHRoaXMuYWRkRXZlbnQpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NhbGVuZGFyLS1yZWZyZXNoJywgKCkgPT4gdGhpcy5lYy5yZWZldGNoRXZlbnRzKCkpXG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkRXZlbnQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5lYy5hZGRFdmVudChldmVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0RXZlbnRDb250ZW50OiBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBldmVudENvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2V2ZW50Q29udGVudCcsIGV2ZW50Q29udGVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcENvbnRlbnQoZXZlbnRDb250ZW50LCBpbmZvKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBldmVudENvbnRlbnQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kZWwgPSBpbmZvLmV2ZW50LmV4dGVuZGVkUHJvcHMubW9kZWw7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGV2ZW50Q29udGVudFttb2RlbF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcENvbnRlbnQoY29udGVudCwgaW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0TW9yZUxpbmtDb250ZW50OiBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcENvbnRlbnQobW9yZUxpbmtDb250ZW50LCBpbmZvKTtcbiAgICAgICAgfSxcblxuICAgICAgICB3cmFwQ29udGVudDogZnVuY3Rpb24gKGNvbnRlbnQsIGluZm8pIHtcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBjb250ZW50O1xuXG4gICAgICAgICAgICAvLyBBZGQgYWxwaW5lIGRhdGEgYW5kIGNsYXNzZXNcbiAgICAgICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3gtZGF0YScsIEpTT04uc3RyaW5naWZ5KGluZm8pKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCd3LWZ1bGwnKTtcblxuICAgICAgICAgICAgLy8gR2V0IHRoZSBtb2RpZmllZCBIVE1MXG4gICAgICAgICAgICByZXR1cm4gY29udGFpbmVyLm91dGVySFRNTDtcbiAgICAgICAgfSxcbiAgICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiO0FBQWUsU0FBUixlQUFnQztBQUFBLEVBQ0ksT0FBTztBQUFBLEVBQ1AsU0FBUztBQUFBLEVBQ1QsV0FBVztBQUFBLEVBQ1gsU0FBUyxDQUFDO0FBQUEsRUFDVixlQUFl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
